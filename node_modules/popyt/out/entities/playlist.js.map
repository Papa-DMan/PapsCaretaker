{"version":3,"sources":["../src/entities/playlist.ts"],"names":[],"mappings":"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","file":"playlist.js","sourcesContent":["import { YouTube, Video, Thumbnail } from '..'\nimport { GenericService } from '../services'\n\n/**\n * A YouTube playlist.\n */\nexport class Playlist {\n  /**\n   * The name of the endpoint used for this entity.\n   */\n  public static endpoint = 'playlists'\n\n  /**\n   * The parts to request for this entity.\n   */\n  public static part = 'snippet,contentDetails,player'\n\n  /**\n   * The fields to request for this entity.\n   */\n  public static fields = 'items(kind,id,snippet(tags,title,description,channelId,publishedAt,thumbnails),contentDetails(itemCount),player(embedHtml))'\n\n  /**\n   * The YouTube object that created this playlist.\n   */\n  public youtube: YouTube\n\n  /**\n   * The raw data of this playlist.\n   */\n  public data: any\n\n  /**\n   * Whether or not this is a full playlist object.\n   */\n  public full: boolean\n\n  /**\n   * The ID of this playlist.\n   */\n  public id: string\n\n  /**\n   * The title of the playlist.\n   */\n  public title: string\n\n  /**\n   * The description of the playlist.\n   */\n  public description: string\n\n  /**\n   * The videos in the playlist. Only available after calling `Playlist#fetchVideos()`.\n   */\n  public videos: Video[]\n\n  /**\n   * The ID of the creator of the playlist.\n   */\n  public creatorId: string\n\n  /**\n   * The url of the playlist.\n   */\n  public url: string\n\n  /**\n   * The date the playlist was created.\n   */\n  public dateCreated: Date\n\n  /**\n   * The thumbnails for the playlist.\n   */\n  public thumbnails: {\n    default?: Thumbnail\n    high?: Thumbnail\n    maxres?: Thumbnail\n    medium?: Thumbnail\n    standard?: Thumbnail\n  }\n\n  /**\n   * The number of items in the playlist.\n   */\n  public length: number\n\n  /**\n   * An \\<iframe\\> tag that embeds a player that will play the playlist.\n   */\n  public embedHtml: string\n\n  /**\n   * The tags of the playlist.\n   */\n  public tags: string[]\n\n  constructor (youtube: YouTube, data: any) {\n    this.youtube = youtube\n    this.data = data\n\n    this._init(data)\n  }\n\n  /**\n   * @ignore\n   */\n  private _init (data: any) {\n    if (data.kind === 'youtube#playlist') {\n      const playlist = data\n\n      this.id = playlist.id\n      /* istanbul ignore next */\n      this.tags = playlist.snippet ? playlist.snippet.tags : undefined\n      /* istanbul ignore next */\n      this.length = playlist.contentDetails ? playlist.contentDetails.itemCount : undefined\n      /* istanbul ignore next */\n      this.embedHtml = playlist.player ? playlist.player.embedHtml : undefined\n    } else if (data.kind === 'youtube#searchResult') {\n      this.full = false\n      this.id = data.id.playlistId\n    } else {\n      throw new Error(`Invalid playlist type: ${data.kind}`)\n    }\n\n    /* istanbul ignore next */\n    if (data.snippet) {\n      this.tags = data.snippet.tags\n      this.title = data.snippet.title\n      this.description = data.snippet.description\n      this.creatorId = data.snippet.channelId\n      this.dateCreated = new Date(data.snippet.publishedAt)\n      this.thumbnails = data.snippet.thumbnails\n    } else {\n      this.full = false\n    }\n\n    this.url = `https://youtube.com/playlist?list=${this.id}`\n  }\n\n  /**\n   * Adds videos in this playlist to the `videos` property of this playlist.\n   * @param maxResults Fetches all videos if <=0.\n   */\n  public async fetchVideos (maxResults: number = 10) {\n    this.videos = await this.youtube.getPlaylistItems(this.id, maxResults)\n    return this.videos\n  }\n\n  /**\n   * Fetches this playlist and reassigns this object to the new playlist object.\n   * Only useful if `this.full` is false, or if you want updated playlist info.\n   */\n  public async fetch () {\n    const playlist = await this.youtube.getPlaylist(this.id)\n    return Object.assign(this, playlist)\n  }\n\n  /**\n   * Edits the playlist.\n   * Must be using an access token with correct scopes.  \n   * **If your request does not specify a value for a property that already has a value,\n   * the property's existing value will be deleted.**\n   * @param title A title for the playlist.\n   * @param description A description of the playlist.\n   * @param privacy Whether the video is private, public, or unlisted.\n   * @param tags Tags pertaining to the playlist.\n   * @param language The language of the playlist's default title and description.\n   * @param localizations Translated titles and descriptions.\n   */\n  /* istanbul ignore next */\n  public async update (title: string, description?: string, privacy?: 'private' | 'public' | 'unlisted', tags?: string[], language?: string,\n    localizations?: {[language: string]: { title: string; description: string }}): Promise<Playlist> {\n    const newPlaylist = await this.youtube.oauth.updatePlaylist(this.id, title, description, privacy, tags, language, localizations)\n    return Object.assign(this, { ...newPlaylist, full: true })\n  }\n\n  /**\n   * Adds a [[Video]] to the playlist.\n   * Must be using an access token with correct scopes.\n   * @param videoResolvable The URL, ID, or Title of the video.\n   * @param position The zero-based position to insert the video in.\n   * @param note A note on the video.\n   */\n  /* istanbul ignore next */\n  public async addVideo (videoResolvable: string | Video, position?: number, note?: string) {\n    const videoId = await GenericService.getId(this.youtube, videoResolvable, Video)\n    const video = await this.youtube.oauth.addPlaylistItem(this.id, videoId, position, note)\n\n    if (this.videos) {\n      this.videos.push(video)\n    } else {\n      this.videos = [ video ]\n    }\n\n    return video\n  }\n\n  /**\n   * Updates a [[Video]] in the playlist.\n   * Must be using an access token with correct scopes.\n   * @param videoResolvable The URL, ID, or Title of the video.\n   * @param position The zero-based position to move the video to.\n   * @param note A new note on the video.\n   * @param itemId The playlist item ID if you have it.\n   */\n  /* istanbul ignore next */\n  public async updateVideo (videoResolvable: string | Video, position?: number, note?: string, itemId?: string) {\n    const videoId = await GenericService.getId(this.youtube, videoResolvable, Video)\n    const playlistItemId = itemId ? itemId : (await GenericService.getPaginatedItems(this.youtube, 'playlistItems', false, this.id, 1, videoId))[0].id\n\n    return this.youtube.oauth.updatePlaylistItem(playlistItemId, this.id, videoId, position, note)\n  }\n\n  /**\n   * Removes a [[Video]] from the playlist.\n   * Must be using an access token with correct scopes.\n   * @param videoResolvable The URL, ID, or Title of the video. Must specify this or `itemId`.\n   * @param itemId The playlist item ID if you have it. Must specify this or `videoResolvable`.\n   */\n  /* istanbul ignore next */\n  public async removeVideo (videoResolvable?: string, itemId?: string) {\n    if (!videoResolvable && !itemId) {\n      return Promise.reject('Must specify either videoResolvable or itemId')\n    }\n\n    const playlistItemId = itemId ? itemId : (await GenericService.getPaginatedItems(this.youtube, 'playlistItems', false, this.id, 1,\n      await GenericService.getId(this.youtube, videoResolvable, Video)))[0].id\n\n    await this.youtube.oauth.deletePlaylistItem(playlistItemId)\n\n    if (this.videos) {\n      const index = this.videos.findIndex(v => v.data.id === playlistItemId)\n\n      if (index) {\n        this.videos.splice(index, 1)\n      }\n    }\n  }\n\n  /**\n   * Deletes the playlist.\n   * Must be using an access token with correct scopes.\n   */\n  /* istanbul ignore next */\n  public delete () {\n    return this.youtube.oauth.deletePlaylist(this.id)\n  }\n}\n"],"sourceRoot":"../../src"}