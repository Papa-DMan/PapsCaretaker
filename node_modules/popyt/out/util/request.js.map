{"version":3,"sources":["../src/util/request.ts"],"names":[],"mappings":"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","file":"request.js","sourcesContent":["import { request as https } from 'https'\nimport { IncomingMessage, RequestOptions, OutgoingMessage } from 'http'\nimport { parse as parseUrl } from 'url'\n\n/**\n * @ignore\n */\n/* istanbul ignore next */\nexport class Request {\n  public baseUrl?: string\n\n  constructor (baseUrl?: string) {\n    this.baseUrl = baseUrl\n  }\n\n  public api (subUrl: string, params?: Object, token?: string, accessToken?: string): Promise<any> {\n    const url = this.formUrl(subUrl, params, token, accessToken)\n    return this.get(url, accessToken)\n  }\n\n  public post (subUrl: string, params?: Object, data?: any, token?: string, accessToken?: string): Promise<any> {\n    const url = this.formUrl(subUrl, params, token, accessToken)\n    return this._post(url, data, accessToken)\n  }\n\n  public put (subUrl: string, params?: Object, data?: any, token?: string, accessToken?: string): Promise<any> {\n    const url = this.formUrl(subUrl, params, token, accessToken)\n    return this._put(url, data, accessToken)\n  }\n\n  public delete (subUrl: string, params?: Object, token?: string, accessToken?: string): Promise<any> {\n    const url = this.formUrl(subUrl, params, token, accessToken)\n    return this._delete(url, accessToken)\n  }\n\n  public imagePost (subUrl: string, image: Buffer, imageType: 'jpeg' | 'png', params?: Object, token?: string, accessToken?: string): Promise<any> {\n    const url = this.formUrl(subUrl, params, token, accessToken)\n    return this._post(url, image, accessToken, `image/${imageType}`)\n  }\n\n  public streamPut (subUrl: string, stream: Buffer, params?: Object, token?: string, accessToken?: string): Promise<any> {\n    const url = this.formUrl(subUrl, params, token, accessToken)\n    return this._put(url, stream, accessToken, 'application/octet-stream')\n  }\n\n  public multipartStreamPost (subUrl: string, data: any, extraData: Buffer, params?: Object, token?: string, accessToken?: string): Promise<any> {\n    const url = this.formUrl(subUrl, params, token, accessToken)\n    const boundary = this.generateBoundary()\n\n    return this._postMultipart(url, data, extraData, accessToken, 'application/json', 'application/octet-stream', boundary)\n  }\n\n  public multipartImagePost (subUrl: string, data: any, image: Buffer, imageType: 'jpeg' | 'png', params?: Object, token?: string, accessToken?: string): Promise<any> {\n    const url = this.formUrl(subUrl, params, token, accessToken)\n    const boundary = this.generateBoundary()\n\n    return this._postMultipart(url, data, image, accessToken, 'application/json', `image/${imageType}`, boundary)\n  }\n\n  public multipartStreamPut (subUrl: string, data: any, extraData: Buffer, params?: Object, token?: string, accessToken?: string): Promise<any> {\n    const url = this.formUrl(subUrl, params, token, accessToken)\n    const boundary = this.generateBoundary()\n\n    return this._putMultipart(url, data, extraData, accessToken, 'application/json', 'application/octet-stream', boundary)\n  }\n\n  private get (url: string, token?: string, contentType: string = 'application/json'): Promise<any> {\n    const options = this.parseUrlToOptions(url, 'GET', contentType)\n\n    if (token) {\n      options.headers['Authorization'] = `Bearer ${token}`\n    }\n\n    return this.req(options, req => this.reqCallback(req))\n  }\n\n  private _post (url: string, data: any, token: string, contentType: string = 'application/json'): Promise<any> {\n    const options = this.parseUrlToOptions(url, 'POST', contentType)\n\n    if (token) {\n      options.headers['Authorization'] = `Bearer ${token}`\n    }\n\n    return this.req(options, req => this.reqCallback(req, data))\n  }\n\n  private _put (url: string, data: any, token: string, contentType: string = 'application/json'): Promise<any> {\n    const options = this.parseUrlToOptions(url, 'PUT', contentType)\n\n    if (token) {\n      options.headers['Authorization'] = `Bearer ${token}`\n    }\n\n    return this.req(options, req => this.reqCallback(req, data))\n  }\n\n  private _delete (url: string, token: string, contentType: string = 'application/json'): Promise<any> {\n    const options = this.parseUrlToOptions(url, 'DELETE', contentType)\n\n    if (token) {\n      options.headers['Authorization'] = `Bearer ${token}`\n    }\n\n    return this.req(options, req => this.reqCallback(req))\n  }\n\n  private _postMultipart (url: string, data: any, extraData: Buffer, token: string, contentType: string, extraType: string, boundary: string): Promise<any> {\n    const options = this.parseUrlToOptions(url, 'POST', `multipart/form-data; boundary=${boundary}`)\n\n    if (token) {\n      options.headers['Authorization'] = `Bearer ${token}`\n    }\n\n    return this.req(options, req => this.reqCallbackMultipart(req, [ { data, type: contentType }, { data: extraData, type: extraType } ], boundary))\n  }\n\n  private _putMultipart (url: string, data: any, extraData: Buffer, token: string, contentType: string, extraType: string, boundary: string): Promise<any> {\n    const options = this.parseUrlToOptions(url, 'PUT', `multipart/form-data; boundary=${boundary}`)\n\n    if (token) {\n      options.headers['Authorization'] = `Bearer ${token}`\n    }\n\n    return this.req(options, req => this.reqCallbackMultipart(req, [ { data, type: contentType }, { data: extraData, type: extraType } ], boundary))\n  }\n\n  private formUrl (subUrl: string, params?: object, token?: string, accessToken?: string) {\n    return this.baseUrl + (subUrl.startsWith('/') ? '' : '/') + subUrl + this.parseParams(params) + (!accessToken ? (params ? `&key=${token}` : `?key=${token}`) : '')\n  }\n\n  private parseUrlToOptions (url: string, type: 'POST' | 'PUT' | 'GET' | 'DELETE', contentType: string): RequestOptions {\n    const parsed = parseUrl(url)\n\n    return {\n      hostname: parsed.hostname,\n      port: parsed.port ? parsed.port : 443,\n      path: parsed.path,\n      method: type,\n      headers: {\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        'Content-Type': contentType\n      }\n    }\n  }\n\n  private generateBoundary () {\n    let boundary = '--------------------------'\n\n    for (let i = 0; i < 24; i++) {\n      boundary += Math.floor(Math.random() * 10).toString(16)\n    }\n\n    return boundary\n  }\n\n  private req (options: RequestOptions, reqFunction: (req: OutgoingMessage) => void) {\n    return new Promise((resolve, reject) => {\n      const cb = (res: IncomingMessage) => {\n        let data = ''\n\n        res.setEncoding('utf8')\n\n        res.on('data', chunk => {\n          data += chunk\n        })\n\n        res.on('end', () => {\n          if (res.statusCode === 404) {\n            return reject(new Error('Not found'))\n          }\n\n          // no content\n          if (res.statusCode === 204) {\n            return resolve()\n          }\n\n          if (res.headers['content-type'].startsWith('application/octet-stream')) {\n            return resolve(Buffer.from(data))\n          }\n\n          if (!res.headers['content-type'].startsWith('application/json')) {\n            return reject('Unexpected content type: ' + res.headers['content-type'] + '\\nData: ' + data)\n          }\n\n          let parsed: any\n\n          try {\n            parsed = JSON.parse(data)\n          } catch(err) {\n            return reject('Error parsing JSON response: ' + data)\n          }\n\n          if (parsed.error) {\n            return reject(new Error(parsed.error.message))\n          }\n\n          return resolve(parsed)\n        })\n\n        res.on('error', error => {\n          return reject(error)\n        })\n      }\n\n      reqFunction(https(options, cb))\n    })\n  }\n\n  private reqCallback (req: OutgoingMessage, data?: any) {\n    req.on('error', error => {\n      throw error\n    })\n\n    if (data) {\n      req.write(data)\n    }\n\n    req.end()\n  }\n\n  private reqCallbackMultipart (req: OutgoingMessage, data: { type: string; data: any }[], boundary: string) {\n    req.on('error', error => {\n      throw error\n    })\n\n    for (let i = 0; i < data.length; i++) {\n      req.write(`--${boundary}\\n`)\n      req.write(`Content-Disposition: form-data; name=\"${i}\"\\n`)\n      req.write(`Content-Type: ${data[i].type}\\n\\n`)\n\n      req.write(data[i].data)\n      req.write('\\n')\n    }\n\n    req.write(`--${boundary}--`)\n    req.end()\n  }\n\n  private parseParams (params: Object) {\n    if (!params) {\n      return ''\n    }\n\n    let url = ''\n\n    for (let param in params) {\n      url += (!url.includes('?') ? '?' : '&') + param + '=' + params[param]\n    }\n\n    return url\n  }\n}\n"],"sourceRoot":"../../src"}