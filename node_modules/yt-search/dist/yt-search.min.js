!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ytSearch=t()}}(function(){return function i(o,s,l){function u(e,t){if(!s[e]){if(!o[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(c)return c(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var a=s[e]={exports:{}};o[e][0].call(a.exports,function(t){return u(o[e][1][t]||t)},a,a.exports,i,o,s,l)}return s[e].exports}for(var c="function"==typeof require&&require,t=0;t<l.length;t++)u(l[t]);return u}({1:[function(u,t,e){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var E=u("cheerio"),c=u("dasu");u("async.parallellimit");c.follow=!1,c.debug=!1;var p="Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html) (yt-search; https://www.npmjs.com/package/yt-search)",d=u("url"),r={};Object.keys(process.env).forEach(function(t){var e=process.env[t];if("0"==e||"false"==e||!e)return r[t]=!1;r[t]=e});var f=r.debug;function U(){f&&console.log.apply(this,arguments)}var n,k=u("querystring"),N=u("human-time"),h={YT:"https://youtube.com",SEARCH_MOBILE:"https://m.youtube.com/results",SEARCH_DESKTOP:"https://www.youtube.com/results"};function i(t,e){if(!e)return new Promise(function(r,n){i(t,function(t,e){if(t)return n(t);r(e)})});var r=void 0;if((r="string"==typeof t?{query:t}:t).userAgent&&(p=r.userAgent),r.search=r.query||r.search,r.original_search=r.search,r.videoId)return function(t,i){U("fn: getVideoMetaData");var e=void 0;"string"==typeof t&&(e=t);"object"===(void 0===t?"undefined":o(t))&&(e=t.videoId);var r="https://www.youtube.com/watch?hl=en&gl=US&v="+e,n=d.parse(r);n.headers={"user-agent":p},c.req(n,function(t,e,r){if(t)i(t);else{if(200!==e.status)return i("http status: "+e.status);if(f){var n=u("fs");u("path");n.writeFileSync("dasu.response",e.responseText,"utf8")}try{!function(t,e){U("parseVideoBody");var r=E.load(t),n=r("#content"),i=r("meta[itemprop=videoId]",n).attr("content");if(!i)return e("video unavailable");var o="",s="",l="",u="",c="",p="",d=r('link[href*="/user/"]',n)||r('a[href*="/user/"]');if(d){var f=d.attr("href")||"";f&&(l=f.split("/").pop(),u="https://youtube.com/user/"+l)}c=r(".yt-user-info a").text().trim();var h=r('link[href*="/channel/"]',n)||r('a[href*="/channel/"');if(o=r("meta[itemprop=channelId]",n).attr("content"),s="https://youtube.com/channel/"+o,h){var m=h.attr("href")||"";m&&(o=m.split("/").pop(),s="https://youtube.com/channel/"+o)}var v="https://i.ytimg.com/vi/"+i+"/hqdefault.jpg",g=r('script[type="application/ld+json"]').text();try{var y=JSON.parse(g);p=y.itemListElement[0].item.name}catch(t){}var b="",x=r("meta[itemprop=duration]",n).attr("content");x&&(b=function(t){U("parseHumanDuration");var e=t.slice(0,2),r=t.slice(2).toUpperCase();if("PT"!==e)return{toString:function(){return a[0]},seconds:0,timestamp:0};var n=r.match(/\d?\dH/),i=r.match(/\d?\dM/),o=r.match(/\d?\dS/);n=n&&n[0].slice(0,-1)||0,i=i&&i[0].slice(0,-1)||0,o=o&&o[0].slice(0,-1)||0,n=parseInt(n),i=parseInt(i),o=parseInt(o),r="",n&&(r+=n+":");i&&(r+=i+":");var s=60*n*60+60*i+o;return{toString:function(){return s+" seconds ("+r+")"},seconds:s,timestamp:r+=o}}(x));if(!b){var w=t.match(/approxDurationMs.*?(\d+)/);if(w&&w[1]){var I=w[1],S=function(t){var e="",r=Math.floor(t/36e5),n=Math.floor(t/6e4)%60,a=Math.floor(t/1e3)%60;r&&(e+=r+":");n&&(e+=n+":");String(a).length<2&&(e+="0");return e+=a}(I);b=O(S)}}var _=r("meta[itemprop=uploadDate]",n).attr("content"),D={title:r("meta[itemprop=name]",n).attr("content"),description:r("meta[itemprop=description]",n).attr("content"),url:r("link[itemprop=url]",n).attr("href"),videoId:i,seconds:Number(b.seconds),timestamp:b.timestamp,duration:b,views:Number(r("meta[itemprop=interactionCount]",n).attr("content")),genre:r("meta[itemprop=genre]",n).attr("content").toLowerCase(),uploadDate:_,ago:N(new Date(_)),image:v,thumbnail:v,author:{name:p||c,id:l||o,url:u||s,userId:l,userName:c,userUrl:u,channelId:o,channelName:p,channelUrl:s}};e(null,D)}(r,i)}catch(t){i(t)}}})}(r.videoId,e);if(r.listId)return function(t,a){U("fn: getPlaylistMetaData");var e=void 0;"string"==typeof t&&(e=t);"object"===(void 0===t?"undefined":o(t))&&(e=t.listId||t.playlistId);var r="https://www.youtube.com/playlist?hl=en&gl=US&list="+e,n=d.parse(r);n.headers={"user-agent":p},c.req(n,function(t,e,r){if(t)a(t);else{if(200!==e.status)return a("http status: "+e.status);if(f){var n=u("fs");u("path");n.writeFileSync("dasu.response",e.responseText,"utf8")}try{!function(t,e){U("fn: parsePlaylistBody");for(var r=E.load(t),n=r(".pl-header-thumb img").attr("src").split("?",2)[0],a=r(".pl-header-content"),i=r(".pl-header-title",a).text().trim(),o=r("#pl-header").attr("data-full-list-id"),s=r(".pl-header-details",a),l=r("li",s),u=q(r("a",l[0])),c=r(l[1]).text().trim(),p=Number(c.replace(/\D+/g,"")),d=r(l[2]).text().trim(),f=Number(d.replace(/\D+/g,"")),h=function(t){U("fn: _parsePlaylistLastUpdateTime");for(var e=t.trim().split(/[\s.-]+/),r=0;r<e.length;r++){var n=e.slice(r),a=n.join(" "),i=n.reverse().join(" "),o=new Date(a),s=new Date(i);if("Invalid Date"!==o.toString())return j(o);if("Invalid Date"!==s.toString())return j(s)}return""}(r(l[3]).text().trim()),m=r("#pl-load-more-destination .pl-video"),v=[],g=0;g<m.length;g++){var y=m[g],b=r(y).attr("data-title"),x=r(y).attr("data-video-id"),w="https://youtube.com/watch?v="+x+"&list="+o,I="https://i.ytimg.com/vi/"+x+"/default.jpg",S="https://i.ytimg.com/vi/"+x+"/hqdefault.jpg",_=r(".pl-video-owner a",y),D=q(_);v.push({title:b,videoId:x,listId:o,url:w,thumbnailUrl:I,thumbnailUrlHQ:S,owner:D.name,author:D})}var N={title:i,listId:o,url:"https://youtube.com/playlist?list="+o,videoCount:p,views:Number(f),date:h,image:n,thumbnail:n,items:v,videos:v,author:u};e(null,N)}(r,a)}catch(t){a(t)}}})}(r.listId,e);if(!r.search)return e(Error("yt-search: no query given"));!function v(g,y){var t=k.escape(g.search).split(/\s+/),e=g.hl||"en",r=g.gl||"US",n=g.category||"",a=Number(g.pageStart)||1,i=Number(g.pageEnd)||Number(g.pages)||1;a<=0&&(a=1)<=i&&(i+=1),Number.isNaN(i)&&y("error: pageEnd must be a number"),g.pageStart=a,g.pageEnd=i,g.currentPage=g.currentPage||a;var o="?";-1===(o+="search_query="+t.join("+")).indexOf("&hl=")&&(o+="&hl="+e),-1===o.indexOf("&gl=")&&(o+="&gl="+r),n&&(o+="&category="+n),g.sp&&(o+="&sp="+g.sp);var s=h.SEARCH_DESKTOP+o,l=d.parse(s);l.headers={"user-agent":p,accept:"text/html","accept-encoding":"gzip","accept-language":"en-US"},U(l),U("getting results: "+g.currentPage),c.req(l,function(t,e,r){if(t)y(t);else{if(200!==e.status)return y("http status: "+e.status);if(f){var n=u("fs");u("path"),n.writeFileSync("dasu.response",e.responseText,"utf8")}try{m(r,function(t,e){if(t)return y(t);var r=e,n=r.filter(b),a=r.filter(x),i=r.filter(w);g._data=g._data||{},g._data.videos=g._data.videos||[],g._data.playlists=g._data.playlists||[],g._data.channels=g._data.channels||[],n.forEach(function(t){g._data.videos.push(t)}),a.forEach(function(t){g._data.playlists.push(t)}),i.forEach(function(t){g._data.channels.push(t)}),g.currentPage++;var o=g.currentPage<=g.pageEnd;if(o&&e._sp)g.sp=e._sp,setTimeout(function(){v(g,y)},1500);else{for(var s=g._data.videos.filter(b),l=g._data.playlists.filter(x),u=g._data.channels.filter(w),c=[],p=[],d=0;d<s.length;d++){var f=s[d];f.views<5?p.push(f):c.push(f)}for(var h=0;h<p.length;h++){var m=p[h];c.push(m)}y(null,{videos:c,playlists:l,lists:l,accounts:u,channels:u})}})}catch(t){y(t)}}})}(r,e)}function b(t,e,r){if("video"!==t.type)return!1;var n=t.videoId;return r.findIndex(function(t){return n===t.videoId})===e}function x(t,e,r){if("list"!==t.type)return!1;var n=t.listId;return r.findIndex(function(t){return n===t.listId})===e}function w(t,e,r){if("channel"!==t.type)return!1;var n=t.url;return r.findIndex(function(t){return n===t.url})===e}function m(t,e){var r=E.load(t),n=r("li .yt-lockup-tile"),a=[],i=[];try{var o=r("div.search-pager > button ~")[0];a._sp=o.attribs.href.split("&sp=")[1]}catch(t){U("next page results link not found")}for(var s=0;s<n.length;s++){var l=r(n[s]);try{var u=v(r,l);u&&a.push(u)}catch(t){i.push(t)}}e(i[0]||void 0,a)}function v(t,e){var r=t("a",e).attr("href")||"",n=k.parse(r.split("?",2)[1]);return n.list?function(t,e){var r=t(".yt-lockup-content",e),n=t(".yt-lockup-title",r),a=t("a",n),i=a.text().trim(),o=a.attr("href"),s=k.parse(o.split("?",2)[1]),l=s.list,u=s.v,c="",p="",d="",f="",h="",m="",v=t(".yt-lockup-byline",r),g=t("a",v),y=g.attr("href")||"";if(y)0<=y.indexOf("channel/")&&(c=y.split("/").pop(),p="https://youtube.com/channel/"+c,d=g.text().trim()),0<=y.indexOf("user/")&&(f=y.split("/").pop(),h="https://youtube.com/user/"+f,m=g.text().trim());else{var b=v.text().trim();m=b}var x=t(".sidebar",e).text().trim(),w=Number(x.replace(/\D+/g,"")),I=t("li.yt-lockup-playlist-item",r),S=t("a",I[0]).attr("href"),_=k.parse(S.split("?",2)[1]).v,D=u||_,N="https://i.ytimg.com/vi/"+D+"/hqdefault.jpg";return{type:"list",title:i,url:"https://youtube.com/playlist?list="+l,listId:l,videoCountLabel:x,videoCount:w,image:N,thumbnail:N,author:{name:m||d,id:f||c,url:h||p,userId:f,userUrl:h,userName:m,channelId:c,channelUrl:p,channelName:d}}}(t,e):0===r.indexOf("/channel/")||0===r.indexOf("/user/")?function(t,e){var r="https:"+t("img",e).attr("src"),n=t(".yt-lockup-content",e),a=t(".yt-lockup-title",n),i=t("a",a),o=(i.text().trim(),i.attr("href")||""),s="",l="",u="",c="",p="",d="";0<=o.indexOf("channel/")&&(s=o.split("/").pop(),l="https://youtube.com/channel/"+s,u=i.text().trim());0<=o.indexOf("user/")&&(c=o.split("/").pop(),p="https://youtube.com/user/"+c,d=i.text().trim());var f=t(".yt-lockup-meta-info",n).text().trim(),h=Number(f.replace(/\D+/g,"")),m=t(".yt-lockup-description",n).text().trim();return v={type:"channel",title:d||u,description:m,url:p||l,videoCountLabel:f,videoCount:h,image:r,thumbnail:r,name:d||u,id:c||s},g="url",y=p||l,g in v?Object.defineProperty(v,g,{value:y,enumerable:!0,configurable:!0,writable:!0}):v[g]=y,v;var v,g,y}(t,e):n.v?function(t,e){var r=t(".yt-lockup-content",e),n=t(".yt-lockup-title",r),a=(t("img",e).src,t("a",n)),i=O(t("span",n).text()),o=a.attr("href")||"",s=k.parse(o.split("?",2)[1]).v,l=t(".yt-lockup-description",r).text().trim(),u=t(".yt-lockup-meta-info",r),c=t("li",u),p=t(c[0]).text(),d=t(c[1]).text(),f=Number(d.split(" ")[0].split(",").join("").trim()),h="",m="",v="",g="",y=t('a[href^="/user/"]',r);y&&(v=(y.attr("href")||"").replace("/user/","").trim(),g=y.text().trim());var b=t('a[href^="/channel/"]',r);b&&(h=(b.attr("href")||"").replace("/channel/","").trim(),m=b.text().trim());h&&"https://youtube.com/channel/"+h;v&&"https://youtube.com/user/"+v;var x="https://i.ytimg.com/vi/"+s+"/hqdefault.jpg";return{type:"video",title:a.text().trim(),description:l,url:"https://youtube.com/watch?v="+s,videoId:s,seconds:Number(i.seconds),timestamp:i.timestamp,duration:i,views:Number(f),image:x,thumbnail:x,ago:p,author:{name:g||m,url:y.attr("href")||b.attr("href")}}}(t,e):void 0}function O(t){var e=t.split(/\s+/),r=e[e.length-1].replace(/[^:.\d]/g,"");if(!r)return{toString:function(){return e[0]},seconds:0,timestamp:0};for(;r[r.length-1].match(/\D/);)r=r.slice(0,-1);for(var n=(r=r.replace(/\./g,":")).split(/[:.]/),a=0,i=0,o=n.length-1;0<=o;o--)if(!(n[o].length<=0)){var s=n[o].replace(/\D/g,"");if(a+=parseInt(s)*(0<i?Math.pow(60,i):1),2<++i)break}return{toString:function(){return a+" seconds ("+r+")"},seconds:a,timestamp:r}}function q(t){U("fn: _parseAuthorAnchorTag");var e="",r="",n="",a="",i="",o="",s=t.attr("href");return s?(0<=s.indexOf("channel/")&&(r="https://youtube.com/channel/"+(e=s.split("/").pop()),n=t.text().trim()),0<=s.indexOf("user/")&&(i="https://youtube.com/user/"+(a=s.split("/").pop()),o=t.text().trim()),{name:o||n,id:a||e,url:i||r,channelId:e,channelUrl:r,channelUrlText:n,userId:a,userUrl:i,userUrlText:o}):{}}function j(t){return U("fn: _toInternalDateString"),t.getUTCFullYear()+"-"+t.getUTCMonth()+"-"+t.getUTCDate()}t.exports=function(t,e){return i(t,e)},t.exports.search=i,u.main===t&&(n="superman theme list pewdiepie channel",console.log("test: doing list search"),i({query:n,pageEnd:1},function(t,e){if(t)throw t;var r=e.videos,n=e.playlists,a=e.channels;console.log("videos: "+r.length),console.log("playlists: "+n.length),console.log("channels: "+a.length);for(var i=0;i<r.length;i++){var o=r[i],s=" ("+o.timestamp+")";console.log(o.title+s)}n.forEach(function(t){console.log("playlist: "+t.title+" | "+t.listId)}),a.forEach(function(t){console.log("channel: "+t.title+" | "+t.description)})}))},{"async.parallellimit":void 0,cheerio:void 0,dasu:void 0,fs:void 0,"human-time":void 0,path:void 0,querystring:void 0,url:void 0}]},{},[1])(1)});